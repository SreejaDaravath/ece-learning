<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0ea5a4">
    <title>ğŸ“ ECE MASTER - Learn Electronics by Doing!</title>
    <meta name="description" content="Interactive electronics learning game with 50 levels. Build circuits, connect wires, master voltage dividers, logic gates, and digital circuits. Learn ECE hands-on!">
    <meta name="keywords" content="electronics, ECE, learning game, circuits, voltage divider, logic gates, interactive education, STEM">
    <meta name="author" content="ECE Master Team">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sreejadaravath.github.io/ece-learning/">
    <meta property="og:title" content="ECE MASTER - Learn Electronics by Doing">
    <meta property="og:description" content="Interactive game with 50 levels teaching circuits, voltage dividers, logic gates. Build real circuits and master electronics!">
    <meta property="og:image" content="https://sreejadaravath.github.io/ece-learning/preview.png">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://sreejadaravath.github.io/ece-learning/">
    <meta name="twitter:title" content="ECE MASTER - Learn Electronics by Doing">
    <meta name="twitter:description" content="Interactive game with 50 levels teaching circuits, voltage dividers, logic gates. Build real circuits and master electronics!">
    <meta name="twitter:image" content="https://sreejadaravath.github.io/ece-learning/preview.png">
    
    <link rel="stylesheet" href="style.css?v=20251103v4">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <!-- Skip link for keyboard users -->
    <a class="skip-link" href="#main" style="position:absolute;left:-999px;top:auto;" onfocus="this.style.left='10px'" onblur="this.style.left='-999px'">Skip to content</a>
    <!-- ğŸ® Game Header -->
    <header class="game-header" role="banner">
        <div class="header-left">
            <h1>âš¡ ECE MASTER</h1>
            <div class="level-badge">
                <span class="module-name" id="moduleName">Basic Electronics</span>
                <span class="level-number">Level <span id="levelNum">1</span>/50</span>
            </div>
        </div>
        <div class="header-center">
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
                <span class="progress-text" id="progressText">0%</span>
            </div>
        </div>
        <div class="header-right">
            <div class="score-display">
                <span class="score-label">Score:</span>
                <span class="score-value" id="scoreValue">0</span>
            </div>
            <div class="lang-select" style="margin-left:10px;">
                <label for="lang" class="visually-hidden">Language</label>
                <select id="lang" aria-label="Language selector">
                    <option value="en">English</option>
                    <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                </select>
            </div>
            <div class="score-display">
                <span class="score-label">High:</span>
                <span class="score-value gold" id="highScore">0</span>
            </div>
        </div>
    </header>

    <!-- ğŸ¯ Main Game Container -->
    <div class="game-container">
        
        <!-- Left Panel - Component Palette -->
        <aside class="component-palette">
            <h3>ğŸ”§ Components</h3>
            <div class="palette-section" id="componentsList">
                <!-- Components will be dynamically loaded -->
            </div>
            
            <div class="palette-divider"></div>
            
            <h3>ğŸ“Š Tools</h3>
            <div class="tools-section">
                <button class="tool-btn" id="multimeterBtn">
                    <span class="tool-icon">ğŸ”´</span>
                    <span class="tool-name">Multimeter</span>
                </button>
                <button class="tool-btn" id="logicAnalyzerBtn">
                    <span class="tool-icon">ğŸ“ˆ</span>
                    <span class="tool-name">Logic Analyzer</span>
                </button>
                <button class="tool-btn" id="oscilloscopeBtn">
                    <span class="tool-icon">ã€°ï¸</span>
                    <span class="tool-name">Oscilloscope</span>
                </button>
            </div>

            <div class="palette-divider"></div>
            
            <div class="quick-actions">
                <button class="action-btn wire-btn" id="drawWireBtn">
                    <span>ğŸ”Œ</span> Draw Wire
                </button>
                <button class="action-btn clear-btn" id="clearCircuit">
                    <span>ğŸ—‘ï¸</span> Clear All
                </button>
                <button class="action-btn hint-btn" id="getHint">
                    <span>ğŸ’¡</span> Hint (-25pts)
                </button>
                <button class="action-btn assistant-btn" id="eceAssistant" aria-label="ECE AI Assistant with Webcam">
                    <span>ğŸ“¹</span> ECE Assistant
                </button>
            </div>
        </aside>

        <!-- Center Panel - Workspace -->
        <main class="workspace">
            <!-- Task Description -->
            <div class="task-panel" id="taskPanel">
                <div class="task-header">
                    <h2 class="task-title" id="taskTitle">Connect Your First LED</h2>
                    <div class="timer" id="timer">
                        <span class="timer-icon">â±ï¸</span>
                        <span class="timer-value" id="timerValue">60s</span>
                    </div>
                </div>
                <p class="task-description" id="taskDescription">
                    Drag a battery and LED. Connect them. Watch it glow! âš¡
                </p>
                <div class="task-goal">
                    <strong>Goal:</strong> <span id="taskGoal">Make the LED glow</span>
                </div>
            </div>

            <!-- Demo Panel (shows at level start) -->
            <div class="demo-panel hidden" id="demoPanel">
                <div class="demo-header">
                    <h3>ğŸ“º Watch Demo (10 seconds)</h3>
                    <div class="demo-timer" id="demoTimer">10s</div>
                </div>
                <canvas id="demoCanvas" width="400" height="300" role="img" aria-label="Demo circuit animation" tabindex="0"></canvas>
                <button class="skip-demo-btn" id="skipDemo">Skip Demo â­ï¸</button>
            </div>

            <!-- Breadboard Canvas -->
            <div class="breadboard-container" id="breadboardContainer">
                <canvas id="breadboard" width="800" height="600" role="img" aria-label="Breadboard workspace" tabindex="0"></canvas>
                
                <!-- Measurement Overlay -->
                <div class="measurement-overlay hidden" id="measurementOverlay">
                    <div class="measurement-box">
                        <div class="measurement-title">ğŸ“Š Measurement</div>
                        <div class="measurement-value" id="measurementValue">--</div>
                        <button class="close-measurement" id="closeMeasurement">âœ•</button>
                    </div>
                </div>
            </div>

            <!-- Control Panel -->
            <div class="control-panel" role="region" aria-label="Level controls">
                <button class="control-btn prev-btn" id="prevLevel" title="Previous Level" aria-label="Previous level">
                    <span class="btn-icon">â†</span>
                    <span class="btn-text">Previous</span>
                </button>
                <button class="control-btn demo-btn" id="watchDemo" title="Watch demonstration" aria-label="Watch demo">
                    <span class="btn-icon">ğŸ“º</span>
                    <span class="btn-text">Watch Demo</span>
                </button>
                <button class="control-btn answer-btn" id="showAnswer" title="Auto-build circuit (-50 points)" aria-label="Show answer (costs 50 points)">
                    <span class="btn-icon">ğŸ‘ï¸</span>
                    <span class="btn-text">Show Answer</span>
                </button>
                <button class="control-btn test-btn" id="testCircuit" title="Test your circuit" aria-label="Test circuit">
                    <span class="btn-icon">ğŸ§ª</span>
                    <span class="btn-text">Test Circuit</span>
                </button>
                <button class="control-btn submit-btn" id="submitAnswer" title="Submit your answer" aria-label="Submit answer">
                    <span class="btn-icon">âœ“</span>
                    <span class="btn-text">Submit</span>
                </button>
                <button class="control-btn retry-btn hidden" id="retryLevel" title="Retry this level" aria-label="Retry level">
                    <span class="btn-icon">ğŸ”„</span>
                    <span class="btn-text">Retry</span>
                </button>
                <button class="control-btn next-btn hidden" id="nextLevel" title="Next level" aria-label="Next level">
                    <span class="btn-icon">â†’</span>
                    <span class="btn-text">Next Level</span>
                </button>
            </div>

            <!-- Feedback Panel -->
            <div class="feedback-panel hidden" id="feedbackPanel">
                <div class="feedback-content" id="feedbackContent">
                    <!-- Feedback will be shown here -->
                </div>
            </div>
        </main>

        <!-- Right Panel - Info & Stats -->
        <aside class="info-panel">
            <h3>ğŸ“ˆ Current Status</h3>
            
            <div class="stat-card">
                <div class="stat-label">Phase</div>
                <div class="stat-value" id="phaseStatus">Learn</div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Attempts</div>
                <div class="stat-value" id="attemptsValue">0/3</div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Time Taken</div>
                <div class="stat-value" id="timeTaken">0s</div>
            </div>

            <div class="divider"></div>

            <h3>ğŸ¯ Measurements</h3>
            <div class="measurements-list" id="measurementsList">
                <div class="measurement-item">
                    <span class="measure-label">Voltage:</span>
                    <span class="measure-value" id="voltageDisplay">--</span>
                </div>
                <div class="measurement-item">
                    <span class="measure-label">Current:</span>
                    <span class="measure-value" id="currentDisplay">--</span>
                </div>
                <div class="measurement-item">
                    <span class="measure-label">Resistance:</span>
                    <span class="measure-value" id="resistanceDisplay">--</span>
                </div>
                <div class="measurement-item">
                    <span class="measure-label">Power:</span>
                    <span class="measure-value" id="powerDisplay">--</span>
                </div>
            </div>

            <div class="divider"></div>

            <h3>ğŸ† Achievements</h3>
            <div class="achievements-list" id="achievementsList">
                <div class="achievement-badge locked">
                    <span class="badge-icon">ğŸ“</span>
                    <span class="badge-name">Scholar</span>
                </div>
                <div class="achievement-badge locked">
                    <span class="badge-icon">âš¡</span>
                    <span class="badge-name">Speed Demon</span>
                </div>
                <div class="achievement-badge locked">
                    <span class="badge-icon">ğŸ¯</span>
                    <span class="badge-name">Perfectionist</span>
                </div>
                <div class="achievement-badge locked">
                    <span class="badge-icon">ğŸ”¥</span>
                    <span class="badge-name">Hot Streak</span>
                </div>
            </div>

            <div class="divider"></div>

            <button class="reset-btn" id="resetProgress">
                <span>ğŸ”„</span> Reset Progress
            </button>
        </aside>
    </div>

    <!-- ğŸ‰ Success Modal -->
    <div class="modal hidden" id="successModal">
        <div class="modal-content success">
            <div class="modal-header">
                <h2>ğŸ‰ Level Complete!</h2>
            </div>
            <div class="modal-body">
                <div class="score-breakdown">
                    <div class="score-item">
                        <span>Base Score:</span>
                        <span class="score-points" id="baseScore">+100</span>
                    </div>
                    <div class="score-item">
                        <span>Time Bonus:</span>
                        <span class="score-points" id="timeBonus">+50</span>
                    </div>
                    <div class="score-item">
                        <span>First Attempt:</span>
                        <span class="score-points" id="attemptBonus">+100</span>
                    </div>
                    <div class="score-item total">
                        <span>Total:</span>
                        <span class="score-points" id="totalScore">+250</span>
                    </div>
                </div>
                <div class="new-achievement" id="newAchievement"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn" id="continueBtn">Continue â†’</button>
            </div>
        </div>
    </div>

    <!-- ğŸ”§ Hint Modal -->
    <div class="modal hidden" id="hintModal">
        <div class="modal-content hint">
            <div class="modal-header">
                <h2>ğŸ’¡ Hint</h2>
                <button class="close-modal" id="closeHint">âœ•</button>
            </div>
            <div class="modal-body">
                <p class="hint-text" id="hintText"></p>
            </div>
        </div>
    </div>

    <!-- ğŸ“Š Multimeter Modal -->
    <div class="modal hidden" id="multimeterModal">
        <div class="modal-content multimeter">
            <div class="modal-header">
                <h2>ğŸ”´ Multimeter</h2>
                <button class="close-modal" id="closeMultimeter">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="multimeter-display">
                    <div class="display-screen">
                        <span class="display-value" id="multimeterReading">0.00</span>
                        <span class="display-unit" id="multimeterUnit">V</span>
                    </div>
                </div>
                <div class="multimeter-controls">
                    <button class="meter-mode-btn active" data-mode="voltage">Voltage (V)</button>
                    <button class="meter-mode-btn" data-mode="current">Current (A)</button>
                    <button class="meter-mode-btn" data-mode="resistance">Resistance (Î©)</button>
                </div>
                <p class="meter-instruction">Click two points on the circuit to measure</p>
            </div>
        </div>
    </div>

    <!-- ğŸ“¹ ECE Assistant Webcam Modal -->
    <div class="modal hidden" id="eceAssistantModal">
        <div class="modal-content assistant">
            <div class="modal-header">
                <h2>ğŸ“¹ ECE AI Assistant</h2>
                <button class="close-modal" id="closeAssistant">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="assistant-container">
                    <div class="webcam-section">
                        <video id="assistantWebcam" width="320" height="240" autoplay style="border-radius: 8px; background: #000;"></video>
                        <canvas id="assistantCanvas" width="320" height="240" style="display:none;"></canvas>
                        <div class="webcam-controls">
                            <button class="webcam-btn" id="startWebcam">
                                <span>ğŸ“·</span> Start Camera
                            </button>
                            <button class="webcam-btn hidden" id="captureCircuit">
                                <span>ğŸ“¸</span> Capture Circuit
                            </button>
                            <button class="webcam-btn hidden" id="stopWebcam">
                                <span>â¹ï¸</span> Stop Camera
                            </button>
                        </div>
                    </div>
                    <div class="assistant-feedback">
                        <h3>ğŸ¤– AI Analysis</h3>
                        <div class="assistant-message" id="assistantMessage">
                            <p>ğŸ‘‹ Hi! I'm your ECE Assistant. I can help you:</p>
                            <ul>
                                <li>âœ… Check if your circuit is correct</li>
                                <li>ğŸ’¡ Give hints about component placement</li>
                                <li>ğŸ” Identify missing connections</li>
                                <li>ğŸ“š Explain circuit concepts</li>
                            </ul>
                            <p style="margin-top:15px; color: #666; font-size: 0.9em;">
                                <strong>How to use:</strong><br>
                                1. Click "Start Camera" to enable your webcam<br>
                                2. Show your circuit to the camera<br>
                                3. Click "Capture Circuit" for instant feedback<br>
                                4. Get smart hints to complete the level!
                            </p>
                        </div>
                    </div>
                </div>
                <div class="assistant-tips">
                    <strong>ğŸ’¡ Quick Tips:</strong>
                    <div class="tip-grid">
                        <button class="tip-btn" data-tip="components">Show All Components</button>
                        <button class="tip-btn" data-tip="connections">Check Connections</button>
                        <button class="tip-btn" data-tip="values">Verify Values</button>
                        <button class="tip-btn" data-tip="theory">Explain Theory</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="levels-data.js?v=20251103v4"></script>
    <script src="game-engine.js?v=20251103v4"></script>
    
    <!-- ECE Assistant Webcam Functionality -->
    <script>
        // ECE Assistant Manager
        const ECEAssistant = {
            stream: null,
            video: null,
            canvas: null,
            ctx: null,
            
            init() {
                this.video = document.getElementById('assistantWebcam');
                this.canvas = document.getElementById('assistantCanvas');
                this.ctx = this.canvas.getContext('2d');
                
                // Button handlers
                document.getElementById('eceAssistant').addEventListener('click', () => {
                    document.getElementById('eceAssistantModal').classList.remove('hidden');
                });
                
                document.getElementById('closeAssistant').addEventListener('click', () => {
                    this.stopCamera();
                    document.getElementById('eceAssistantModal').classList.add('hidden');
                });
                
                document.getElementById('startWebcam').addEventListener('click', () => this.startCamera());
                document.getElementById('stopWebcam').addEventListener('click', () => this.stopCamera());
                document.getElementById('captureCircuit').addEventListener('click', () => this.captureAndAnalyze());
                
                // Tip buttons
                document.querySelectorAll('.tip-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const tip = e.target.dataset.tip;
                        this.showTip(tip);
                    });
                });
            },
            
            async startCamera() {
                try {
                    this.stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { width: 320, height: 240 } 
                    });
                    this.video.srcObject = this.stream;
                    
                    document.getElementById('startWebcam').classList.add('hidden');
                    document.getElementById('captureCircuit').classList.remove('hidden');
                    document.getElementById('stopWebcam').classList.remove('hidden');
                    
                    this.updateMessage('ğŸ“¹ Camera active! Position your circuit in the frame and click "Capture Circuit"', 'success');
                } catch (err) {
                    console.error('Camera access error:', err);
                    this.updateMessage('âŒ Camera access denied. Please allow camera permissions or use Quick Tips below.', 'error');
                }
            },
            
            stopCamera() {
                if (this.stream) {
                    this.stream.getTracks().forEach(track => track.stop());
                    this.video.srcObject = null;
                    this.stream = null;
                    
                    document.getElementById('startWebcam').classList.remove('hidden');
                    document.getElementById('captureCircuit').classList.add('hidden');
                    document.getElementById('stopWebcam').classList.add('hidden');
                }
            },
            
            captureAndAnalyze() {
                // Capture frame from video
                this.ctx.drawImage(this.video, 0, 0, 320, 240);
                
                // Simulate AI analysis (in production, this would call a real AI model)
                this.updateMessage('ğŸ”„ Analyzing your circuit...', 'info');
                
                setTimeout(() => {
                    this.performAnalysis();
                }, 1500);
            },
            
            performAnalysis() {
                // Get current level info from game engine
                const currentLevel = window.game ? window.game.currentLevel : null;
                
                if (!currentLevel) {
                    this.updateMessage('âš ï¸ Please load a level first!', 'warning');
                    return;
                }
                
                // Simulate intelligent feedback based on circuit state
                const feedback = this.generateFeedback(currentLevel);
                this.updateMessage(feedback, 'success');
            },
            
            generateFeedback(level) {
                const tips = [
                    `ğŸ¯ <strong>Circuit Analysis Complete!</strong><br><br>
                    âœ… <strong>Level Goal:</strong> ${level.goal || 'Complete the circuit'}<br><br>
                    ğŸ’¡ <strong>Smart Hints:</strong><br>
                    â€¢ Make sure all components are properly connected<br>
                    â€¢ Check the polarity of your components (+ and -)<br>
                    â€¢ Verify wire connections are complete<br>
                    â€¢ Use the Test Circuit button to validate<br><br>
                    <strong>Need more help?</strong> Click the Hint button for detailed guidance!`,
                    
                    `ğŸ” <strong>Component Check:</strong><br><br>
                    â€¢ Required components detected âœ“<br>
                    â€¢ Double-check component orientations<br>
                    â€¢ Ensure proper power supply connections<br><br>
                    ğŸ’ª You're on the right track! Keep going!`,
                    
                    `âš¡ <strong>Circuit Status:</strong><br><br>
                    â€¢ Components: Looking good!<br>
                    â€¢ Connections: Review your wiring<br>
                    â€¢ Power flow: Check positive/negative terminals<br><br>
                    ğŸ“ Remember: Current flows from + to -`,
                ];
                
                return tips[Math.floor(Math.random() * tips.length)];
            },
            
            showTip(tipType) {
                const currentLevel = window.game ? window.game.currentLevel : null;
                
                const tips = {
                    components: `ğŸ“¦ <strong>Components for this level:</strong><br><br>
                        ${currentLevel && currentLevel.components ? 
                          currentLevel.components.map(c => `â€¢ ${c.type}: ${c.value || ''}`).join('<br>') :
                          'Components will appear in the palette on the left'}<br><br>
                        Drag them onto the breadboard to start building!`,
                    
                    connections: `ğŸ”Œ <strong>Connection Tips:</strong><br><br>
                        â€¢ Click "Draw Wire" to connect components<br>
                        â€¢ Connect positive (+) to positive terminals<br>
                        â€¢ Connect negative (-) to ground or negative terminals<br>
                        â€¢ Complete the circuit path for current to flow<br><br>
                        âš¡ Tip: Use the multimeter to verify connections!`,
                    
                    values: `ğŸ“Š <strong>Component Values:</strong><br><br>
                        â€¢ Check resistor color codes<br>
                        â€¢ Verify voltage ratings on power supplies<br>
                        â€¢ Use the multimeter to measure actual values<br>
                        â€¢ Ensure capacitor polarities are correct<br><br>
                        ğŸ¯ Goal: ${currentLevel ? currentLevel.goal : 'Complete the circuit correctly'}`,
                    
                    theory: `ğŸ“š <strong>Circuit Theory:</strong><br><br>
                        <strong>Ohm's Law:</strong> V = I Ã— R<br>
                        â€¢ V (Voltage) = Electrical pressure<br>
                        â€¢ I (Current) = Flow of electrons<br>
                        â€¢ R (Resistance) = Opposition to flow<br><br>
                        <strong>Kirchhoff's Laws:</strong><br>
                        â€¢ Voltage Law: Sum of voltages in a loop = 0<br>
                        â€¢ Current Law: Current in = Current out<br><br>
                        ğŸ’¡ Apply these principles to solve the level!`
                };
                
                this.updateMessage(tips[tipType] || 'Feature coming soon!', 'info');
            },
            
            updateMessage(html, type = 'info') {
                const messageDiv = document.getElementById('assistantMessage');
                messageDiv.innerHTML = html;
                messageDiv.className = 'assistant-message ' + type;
            }
        };
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            ECEAssistant.init();
        });
    </script>
    
    <script>
        // Register service worker for offline support (graceful if not supported)
        if ('serviceWorker' in navigator) {
            try {
                navigator.serviceWorker.register('/service-worker.js');
                console.log('Service worker registered');
            } catch (err) {
                console.warn('Service worker registration failed', err);
            }
        }
    </script>
</body>
</html>
